"""
Модуль работы с базой данных.
Модели и репозитории сгруппированы по сущностям.
"""
from database.connection import engine
from database.models import (
    Base,
    User,
    ServersTable,
    CountryTable,
    SecurityHashs,
    GiftCodes,
    UserToSubscription,
    ConfigsServers,
    SaleInvoicesInProgress,
)
from database.repositories import (
    BaseRepository,
    get_user_by_id,
    get_user_by,
    get_user_by_country,
    reduce_time_by,
    insert_user,
    update_user_extend_subscription,
    update_user_deactivate,
    get_inactive_users_by_server,
    update_user_renewal,
    check_user_has_active_subscription,
    get_all_telegram_ids,
    get_active_users_by_server,
    update_user_server_link,
    update_user_server_and_link,
    delete_user,
    add_subscription_for_user,
    get_server_list,
    get_country_list,
    get_server_name_by_id,
    get_server_url_by_id,
    get_very_free_server,
    get_info_all_servers,
    get_info_servers,
    update_answers_servers,
    get_token,
    gen_gift_code,
    check_and_consume_gift_code,
    add_sale_invoice,
    get_invoices_with_expiry,
    delete_invoice,
    write_invited,
    increment_balance,
    reset_to_zero_balance,
)

# Инициализация таблиц при импорте
Base.metadata.create_all(engine)

__all__ = [
    'BaseRepository',
    'engine',
    'Base',
    'User',
    'ServersTable',
    'CountryTable',
    'SecurityHashs',
    'GiftCodes',
    'UserToSubscription',
    'ConfigsServers',
    'SaleInvoicesInProgress',
    'get_user_by_id',
    'get_user_by',
    'get_user_by_country',
    'reduce_time_by',
    'insert_user',
    'update_user_extend_subscription',
    'update_user_deactivate',
    'get_inactive_users_by_server',
    'update_user_renewal',
    'check_user_has_active_subscription',
    'get_all_telegram_ids',
    'get_active_users_by_server',
    'update_user_server_link',
    'update_user_server_and_link',
    'delete_user',
    'add_subscription_for_user',
    'get_server_list',
    'get_country_list',
    'get_server_name_by_id',
    'get_server_url_by_id',
    'get_very_free_server',
    'get_info_all_servers',
    'get_info_servers',
    'update_answers_servers',
    'get_token',
    'gen_gift_code',
    'check_and_consume_gift_code',
    'add_sale_invoice',
    'get_invoices_with_expiry',
    'delete_invoice',
    'write_invited',
    'increment_balance',
    'reset_to_zero_balance',
]
